<html>
  <head>
    <title>Meeting Room</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://rawgit.com/Ctrl-Alt-Zen/aframe-mobile-controls/master/components/twoway-motion/twoway-motion.js"></script>
    <script src="https://gftruj.github.io/webzamples/aframe/controls/oculus-thumbstick-controls.js"></script>
  </head>
  <body>
    <a-scene renderer="colorManagement: true;" cursor="rayOrigin: mouse">

      <a-assets>
        <a-asset-item id="chair" src="https://cmhkjuwan.github.io/SmartProject-VR/gltf/chair/chair.gltf"></a-asset-item>
      </a-assets>
      <a-assets>
        <a-asset-item id="desk" src="https://cmhkjuwan.github.io/SmartProject-VR/gltf/desk/desk.gltf"></a-asset-item>
      </a-assets>
      <a-assets>
        <a-asset-item id="carpet" src="https://cmhkjuwan.github.io/SmartProject-VR/gltf/carpet/carpet.gltf"></a-asset-item>
      </a-assets>
      <a-assets>
        <a-asset-item id="window" src="https://cmhkjuwan.github.io/SmartProject-VR/gltf/window/window.gltf"></a-asset-item>
      </a-assets>
      <a-assets>
        <a-asset-item id="tv" src="https://cmhkjuwan.github.io/SmartProject-VR/gltf/tv/tv.gltf"></a-asset-item>
      </a-assets>
      <a-assets>
        <a-asset-item id="whiteboard" src="https://cmhkjuwan.github.io/SmartProject-VR/gltf/whiteboard/whiteboard.gltf"></a-asset-item>
      </a-assets>
      <a-assets>
        <a-asset-item id="door" src="https://cmhkjuwan.github.io/SmartProject-VR/gltf/door/door.gltf"></a-asset-item>
      </a-assets>
      <a-assets>
        <img id="cmhk-logo" src="https://cmhkjuwan.github.io/SmartProject-VR/image/cmhk-logo.jpeg">
      </a-assets>

      <!-- 正前方墙壁 -->
      <a-plane position="0 1.5 -4.6" rotation="0 0 90" width="3" height="11.5" color="#F8F6E3"></a-plane>
      <a-plane position="0 1.5 -4.6" rotation="0 180 90" width="3" height="11.5" color="#F8F6E3"></a-plane>
      <!-- 正后方墙壁 -->
      <a-plane position="0.8 1.5 3.35" rotation="0 0 90" width="3" height="9.92" color="#F8F6E3"></a-plane>
      <a-plane position="0.8 1.5 3.35" rotation="0 180 90" width="3" height="9.92" color="#F8F6E3"></a-plane>
      <!-- 门上方墙壁 -->
      <a-plane position="-4.95 2.55 3.35" rotation="0 0 90" width="0.9" height="1.6" color="#F8F6E3"></a-plane>
      <a-plane position="-4.95 2.55 3.35" rotation="0 180 90" width="0.9" height="1.6" color="#F8F6E3"></a-plane>
      <!-- 正右方墙壁 -->
      <a-plane position="5.75 1.5 -0.6" rotation="0 -90 0" width="8" height="3" color="#F8F6E3"></a-plane>
      <a-plane position="5.75 1.5 -0.6" rotation="0 90 0" width="8" height="3" color="#F8F6E3"></a-plane>
      <!-- 正左方墙壁 -->
      <a-plane position="-5.75 1.5 -0.6" rotation="0 90 0" width="8" height="3" color="#F8F6E3"></a-plane>
      <a-plane position="-5.75 1.5 -0.6" rotation="0 -90 0" width="8" height="3" color="#F8F6E3"></a-plane>
      <a-sky color="#ffffff"></a-sky>

      <a-image src="#cmhk-logo" tv-open id="tv-screen" position="5.6 2 -0.7" scale="1.7 1 1" rotation="0 -90 0"></a-image>
      <a-entity gltf-model="#carpet" position="0 0 -0.65" scale="0.05 0.05 0.05" rotation="0 90 0"></a-entity>
      <a-entity gltf-model="#desk" position="-1.1 0 0" scale="0.015 0.015 0.015" rotation="0 90 0"></a-entity>
      <a-entity gltf-model="#desk" position="1.3 0 0" scale="0.015 0.015 0.015" rotation="0 90 0"></a-entity>
      <a-entity gltf-model="#desk" position="3.7 0 0" scale="0.015 0.015 0.015" rotation="0 90 0"></a-entity>
      <a-entity gltf-model="#chair" position="0 -1 -1.3"></a-entity>
      <a-entity gltf-model="#chair" position="1.2 -1 -1.3"></a-entity>
      <a-entity gltf-model="#chair" position="2.4 -1 -1.3"></a-entity>
      <a-entity gltf-model="#chair" position="-1.2 -1 -1.3"></a-entity>
      <a-entity gltf-model="#chair" position="-2.4 -1 -1.3"></a-entity>
      <a-entity gltf-model="#chair" position="-3.6 -1 -1.3"></a-entity>
      <a-entity gltf-model="#chair" position="0 -1 0" rotation="0 180 0"></a-entity>
      <a-entity gltf-model="#chair" position="1.2 -1 0" rotation="0 180 0"></a-entity>
      <a-entity gltf-model="#chair" position="2.4 -1 0" rotation="0 180 0"></a-entity>
      <a-entity gltf-model="#chair" position="-1.2 -1 0" rotation="0 180 0"></a-entity>
      <a-entity gltf-model="#chair" position="-2.4 -1 0" rotation="0 180 0"></a-entity>
      <a-entity gltf-model="#chair" position="3.6 -1 0" rotation="0 180 0"></a-entity>
      <a-entity gltf-model="#tv" tv-open position="5.65 2 -0.7" rotation="0 -90 0"></a-entity>
      <a-entity gltf-model="#door" id="office-door" door-cursor position="-4.95 1.1 3.3" rotation="0 -90 0"></a-entity>
      <a-entity gltf-model="#whiteboard" raycaster="far: 20; interval: 1000; objects: .clickable" position="3 -0.8 -4.58" rotation="0 0 0" scale="0.02 0.02 0.02"></a-entity>
    
      <a-entity id="rig">
        <a-camera twoway-motion="speed: 35">
          <a-entity cursor="fuse: true; fuseTimeout: 1000"
                  position="0 0 -1"
                  geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                  material="color: white; shader: flat"
                  scale="0.5 0.5 0.5"
                  raycaster="far: 50; interval: 1000; objects: .clickable; showLine: true">
          <a-entity oculus-touch-controls="hand: left" ></a-entity>
          <a-entity oculus-touch-controls="hand: right" oculus-thumbstick-controls></a-entity>
        </a-camera>
      </a-entity>
    </a-scene>
  </body>
  <script type="text/javascript">
    function redirectOffice() {
      window.location.href="https://cmhkjuwan.github.io/SmartProject-VR/office.html";
    }

    function tvControl() {
      var screen = document.querySelector("#tv-screen");
      if(screen.getAttribute("visible")) {
        screen.setAttribute("visible", false);
      } else {
        screen.setAttribute("visible", true);
      }
    }

    AFRAME.registerComponent('door-cursor', {
      init: function () {
        this.el.addEventListener('click', function (evt) {
          redirectOffice();
        });
      }
    });

    // AFRAME.registerComponent('tv-open', {
    //   init: function () {
    //     this.el.addEventListener('click', function (evt) {
    //       var screen = document.querySelector("#tv-screen");
    //       if(screen.getAttribute("visible")) {
    //         screen.setAttribute("visible", false);
    //       } else {
    //         screen.setAttribute("visible", true);
    //       }
    //     });
    //   }
    // });

    var tv;
    var officeDoor;

    window.onload = function() {
      tv = document.getElementById("tv-screen");
      officeDoor = document.getElementById("office-door");
      tv.classList.add("clickable");
      officeDoor.classList.add("clickable");
      tv.addEventListener('click', tvControl);
      officeDoor.addEventListener('click', redirectOffice);
    }

  </script>
</html>